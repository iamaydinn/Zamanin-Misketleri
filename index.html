<!doctype html>
<html lang="tr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Zamanın Misketleri — Dijital Yerleştirme</title>
<style>
  :root{
    --bg:#f6fbff;
    --card:#ffffff;
    --muted:#6b7280;
    --accent:#5b21b6;
    --success:#16a34a;
    --danger:#dc2626;
    --panel:#e6eefc;
    --shadow: 0 6px 18px rgba(11,35,70,0.08);
    font-family: "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
  }
  html,body{height:100%;margin:0;background:var(--bg);color:#0b1220}
  .app{
    max-width:1150px;
    margin:18px auto;
    padding:18px;
  }
  header{
    display:flex;
    gap:12px;
    align-items:center;
    margin-bottom:12px;
  }
  .logo{
    display:flex;
    gap:12px;
    align-items:center;
  }
  .logo .title{
    font-size:20px;font-weight:800;color:var(--accent);
  }
  .controls{
    margin-left:auto;
    display:flex;
    gap:8px;
    align-items:center;
  }
  .btn{
    background:var(--accent);
    color:white;
    border:none;
    padding:8px 12px;
    border-radius:8px;
    cursor:pointer;
    box-shadow:var(--shadow);
    font-weight:600;
  }
  .btn.secondary{
    background:transparent;color:var(--accent);border:2px solid var(--accent);
  }
  .panel{
    background:var(--card);
    padding:12px;border-radius:10px;box-shadow:var(--shadow);
  }

  .top-area{display:flex;gap:12px;margin-bottom:14px}
  .left{
    width:260px; min-height:360px; display:flex; flex-direction:column; gap:10px;
  }
  .team-select{display:flex;flex-direction:column;gap:8px}
  .team-list{display:flex;flex-direction:column;gap:8px}
  .team-item{
    padding:8px;border-radius:8px;background:linear-gradient(90deg,#eef2ff,#fff);display:flex;align-items:center;justify-content:space-between;font-weight:700;color:#0b1220;
  }
  .team-item.active{outline:3px solid rgba(91,33,182,0.12)}
  .score{font-weight:800;color:var(--accent);font-size:18px}
  .add-team{display:flex;gap:6px;align-items:center}
  input[type="text"]{padding:8px;border-radius:8px;border:1px solid #dbeafe;flex:1}

  .middle{
    flex:1; min-height:360px; display:flex;flex-direction:column;gap:12px;
  }
  .eras{display:flex;gap:10px;justify-content:space-between}
  .era{
    flex:1;padding:10px;border-radius:10px;background:var(--panel);min-height:120px;display:flex;flex-direction:column;gap:6px;align-items:center;
    border:2px dashed transparent; transition:all .15s ease;
  }
  .era:hover{transform:translateY(-3px)}
  .era.dragover{border-color:var(--accent);background:linear-gradient(180deg,#eef2ff,#ffffff)}
  .era .era-name{font-weight:800;color:#073b4c}
  .era .era-range{font-size:12px;color:var(--muted)}

  .board{
    display:flex;gap:10px; margin-top:6px;
    flex-wrap:wrap;
    align-items:flex-start;
  }

  .card{
    width:200px;padding:10px;border-radius:8px;background:var(--card);box-shadow:var(--shadow);cursor:grab;margin:6px;
    user-select:none;border-left:6px solid var(--accent);
  }
  .card.small{width:150px}
  .card h4{margin:0 0 6px 0;font-size:14px}
  .card p{margin:0;font-size:13px;color:var(--muted)}

  .right{
    width:260px; display:flex;flex-direction:column;gap:12px;
  }

  .log{height:120px;overflow:auto;padding:8px;background:linear-gradient(180deg,#fff,#fbfbff);border-radius:8px;border:1px dashed #edf2ff}
  .hint{font-size:13px;color:var(--muted)}
  footer{margin-top:14px;text-align:center;color:var(--muted);font-size:13px}

  /* small screens */
  @media (max-width:900px){
    .top-area{flex-direction:column}
    .left,.right{width:100%}
    .eras{flex-direction:row;overflow:auto}
  }
</style>
</head>
<body>
<div class="app">
  <header>
    <div class="logo">
      <svg width="44" height="44" viewBox="0 0 24 24" fill="none"><rect x="1" y="1" width="22" height="22" rx="6" fill="#eef2ff"/><circle cx="8.5" cy="9.5" r="2.4" fill="#6b21a8"/><rect x="13" y="6" width="8" height="2.8" rx="1" fill="#6b21a8"/></svg>
      <div>
        <div class="title">ZAMANIN MİSKETLERİ</div>
        <div style="font-size:12px;color:var(--muted)">Dijital Yerleştirme • Öğrenci Dostu</div>
      </div>
    </div>

    <div class="controls">
      <div id="currentTeamLabel" style="font-weight:700;color:#0b1220;margin-right:8px">Takım: —</div>
      <button class="btn" id="resetBtn">Sıfırla</button>
      <button class="btn secondary" id="helpBtn">Yardım</button>
    </div>
  </header>

  <div class="top-area">
    <div class="left panel">
      <div style="font-weight:800;margin-bottom:8px">Takımlar</div>
      <div class="team-select">
        <div class="team-list" id="teamList"></div>

        <div style="margin-top:6px" class="add-team">
          <input id="teamInput" type="text" placeholder="Yeni takım adı (örn. Mavi Takım)" />
          <button class="btn" id="addTeamBtn">Ekle</button>
        </div>
        <div style="margin-top:8px;color:var(--muted);font-size:13px">Not: Her takım için puan otomatik tutulur.</div>
      </div>
      <hr style="margin:10px 0;border:none;border-top:1px dashed #f0f6ff" />
      <div style="font-weight:800;margin-bottom:6px">Durum</div>
      <div style="display:flex;gap:8px;align-items:center">
        <div style="width:10px;height:10px;background:#ffedd5;border-radius:2px"></div>
        <div class="hint">Sürükle veya kart seç → ardından yuva seç</div>
      </div>

    </div>

    <div class="middle">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div style="font-weight:800">Çağ Yuvaları</div>
        <div style="color:var(--muted);font-size:13px">Doğru yerleştirme: +10 • Yakın: +5 • Yanlış: 0</div>
      </div>

      <div class="eras" id="eras">
        <!-- eras inserted by JS -->
      </div>

      <div style="margin-top:8px;display:flex;align-items:center;justify-content:space-between">
        <div style="font-weight:800">Olay Kartları</div>
        <div style="font-size:13px;color:var(--muted)">Kartlara tıklayıp bir yuva seçebilirsiniz (dokunmatik uyumlu)</div>
      </div>

      <div class="board panel" id="board">
        <!-- cards -->
      </div>
    </div>

    <div class="right panel">
      <div style="font-weight:800">Puan Tablosu</div>
      <div id="scoreboard" style="display:flex;flex-direction:column;gap:8px"></div>

      <div style="margin-top:6px;font-weight:700">Oyun Günlüğü</div>
      <div class="log" id="logArea"></div>

      <div style="margin-top:8px">
        <button class="btn" id="showResults">Sonuçları Göster</button>
        <button class="btn secondary" id="exportBtn" style="margin-left:6px">Skoru Kopyala</button>
      </div>
    </div>
  </div>

  <footer class="hint">Öğretmen ipucu: "Tahmin" teması için yuvalarda tarihleri başta göstermeyerek tartışma turu oluşturabilirsiniz.</footer>
</div>

<script>
/*
  Zamanın Misketleri - Dijital Yerleştirme
  - Takım oluşturma/ seçme
  - Kartları sürükle-bırak veya tıklama ile yuvalara yerleştirme
  - Puanlama: doğru/ yakın / yanlış
  - Basit log ve sonuç gösterimi
*/

// --- Demo veri: çağlar ve kartlar ---
// eras: id, name, rangeStart, rangeEnd (inclusive), displayRange (string)
const ERAS = [
  {id:'ilk', name:'İlk Çağ', rangeStart:-3200, rangeEnd:375, displayRange:'M.Ö. 3200 – M.S. 375', color:'#fef3c7'},
  {id:'orta', name:'Orta Çağ', rangeStart:375, rangeEnd:1453, displayRange:'M.S. 375 – 1453', color:'#ede9fe'},
  {id:'yeni', name:'Yeni Çağ', rangeStart:1453, rangeEnd:1789, displayRange:'1453 – 1789', color:'#dbeafe'},
  {id:'yakin', name:'Yakın Çağ', rangeStart:1789, rangeEnd:2100, displayRange:'1789 – Günümüz', color:'#dcfce7'}
];

// cards: id, title, year (or approximate), short
const CARDS = [
  {id:'c1', title:'İstanbul’un Fethi', year:1453, short:'Bizans’ın başkenti İstanbul Osmanlı tarafından fethedildi.'},
  {id:'c2', title:'Sanayi Devrimi (başlangıç)', year:1769, short:'Buhar makinesiyle başlayan sanayi değişimi.'},
  {id:'c3', title:'Mağara Resimleri (Lascaux)', year:-15000, short:'İnsanların ilk duvar resimleri.'},
  {id:'c4', title:'Rönesans Dönemi', year:1500, short:'Sanat ve bilimde yeniden doğuş.'},
  {id:'c5', title:'Malazgirt Savaşı', year:1071, short:'Türklerin Anadolu’ya girişi.'},
  {id:'c6', title:'Cumhuriyetin İlanı', year:1923, short:'Türkiye Cumhuriyeti kuruldu.'},
  {id:'c7', title:'Matbaanın Avrupa’ya Girişi', year:1450, short:'Bilginin yayılmasını hızlandırdı.'},
  {id:'c8', title:'İlk Yazının İcadı', year:-3200, short:'Yazının bulunmasıyla tarihin başlaması.'},
  {id:'c9', title:'Amerika’nın Keşfi', year:1492, short:'Yeni kıtaların bulunması.'},
  {id:'c10', title:'Ay’a İlk İnsan Yolculuğu', year:1969, short:'Apollo 11 ile Ay yürüyüşü.'}
];

// state
let teams = []; // {id,name,score,color}
let selectedTeamId = null;
let placed = {}; // cardId -> eraId
let logEl, teamListEl, boardEl, erasEl, scoreboardEl;

// utilities
const uid = (p='id') => p + Math.random().toString(36).slice(2,8);
const fmt = n => n>=0? n : `${Math.abs(n)} M.Ö.`;

// init DOM
document.addEventListener('DOMContentLoaded', ()=> {
  logEl = document.getElementById('logArea');
  teamListEl = document.getElementById('teamList');
  boardEl = document.getElementById('board');
  erasEl = document.getElementById('eras');
  scoreboardEl = document.getElementById('scoreboard');

  // build eras
  for(const e of ERAS){
    const d = document.createElement('div');
    d.className = 'era panel';
    d.id = `era-${e.id}`;
    d.dataset.era = e.id;
    d.style.background = `linear-gradient(180deg, ${e.color}, #fff)`;
    d.innerHTML = `<div class="era-name">${e.name}</div><div class="era-range">${e.displayRange}</div><div style="flex:1"></div><div style="font-size:12px;color:var(--muted)">Bırakmak için buraya sürükleyin</div>`;
    erasEl.appendChild(d);
    // drag events
    d.addEventListener('dragover', ev=> ev.preventDefault());
    d.addEventListener('dragenter', ()=> d.classList.add('dragover'));
    d.addEventListener('dragleave', ()=> d.classList.remove('dragover'));
    d.addEventListener('drop', ev=> {
      ev.preventDefault();
      d.classList.remove('dragover');
      const cardId = ev.dataTransfer.getData('text/plain');
      if(cardId) tryPlace(cardId, e.id);
    });
    // touch/click alternative: click era to place selectedCard
    d.addEventListener('click', ()=> {
      if(window._tapSelectedCard) tryPlace(window._tapSelectedCard, e.id);
    });
  }

  // populate board cards
  for(const c of CARDS){
    const el = makeCard(c);
    boardEl.appendChild(el);
  }

  // team sample
  addTeam('Mavi Takım','#0ea5e9');
  addTeam('Turuncu Takım','#f97316');
  addTeam('Yeşil Takım','#10b981');
  addTeam('Kırmızı Takım','#ef4444');

  // buttons
  document.getElementById('addTeamBtn').addEventListener('click', ()=> {
    const v = document.getElementById('teamInput').value.trim();
    if(!v) return alert('Takım adı girin');
    addTeam(v);
    document.getElementById('teamInput').value='';
  });
  document.getElementById('resetBtn').addEventListener('click', resetAll);
  document.getElementById('helpBtn').addEventListener('click', ()=> {
    alert('Kılavuz:\n• Takım seçin.\n• Kartı sürükleyip bir çağa bırakın veya kart seçip çağ kartına tıklayın.\n• Doğru yerleştirme +10 puan, yakın +5, yanlış 0.');
  });
  document.getElementById('showResults').addEventListener('click', showResults);
  document.getElementById('exportBtn').addEventListener('click', ()=> {
    navigator.clipboard.writeText(getScoreText()).then(()=> alert('Skor panosu kopyalandı!'));
  });

  // keyboard accessibility: allow card selection by click
  boardEl.addEventListener('click', (e)=>{
    const c = e.target.closest('.card');
    if(!c) return;
    // toggle selection
    document.querySelectorAll('.card').forEach(x=>x.classList.remove('selected'));
    c.classList.add('selected');
    window._tapSelectedCard = c.dataset.card;
    log(`Kart seçildi: ${c.dataset.cardTitle} — bir yuva seçin`);
  });

});

// create card element
function makeCard(c){
  const el = document.createElement('div');
  el.className = 'card';
  el.draggable = true;
  el.id = `card-${c.id}`;
  el.dataset.card = c.id;
  el.dataset.cardTitle = c.title;
  el.innerHTML = `<h4>${c.title}</h4><p>${c.short}</p>`;
  // dragstart
  el.addEventListener('dragstart', ev=>{
    ev.dataTransfer.setData('text/plain', c.id);
    // for visual feedback
    ev.dataTransfer.effectAllowed = 'move';
  });
  // click for tap workflows
  el.addEventListener('click', ()=> {
    // handled in board click listener (selected)
  });
  return el;
}

// add team
function addTeam(name, color){
  const id = uid('team');
  const team = {id,name,score:0,color: color || randomColor()};
  teams.push(team);
  renderTeams();
  selectTeam(id);
}

function renderTeams(){
  teamListEl.innerHTML = '';
  for(const t of teams){
    const div = document.createElement('div');
    div.className = 'team-item' + (t.id===selectedTeamId ? ' active' : '');
    div.style.borderLeft = `6px solid ${t.color}`;
    div.innerHTML = `<div>${t.name}</div><div class="score" id="score-${t.id}">${t.score}</div>`;
    div.addEventListener('click', ()=> selectTeam(t.id));
    teamListEl.appendChild(div);
  }
  renderScoreboard();
}

function selectTeam(id){
  selectedTeamId = id;
  document.getElementById('currentTeamLabel').textContent = 'Takım: ' + (teams.find(x=>x.id===id)?.name || '—');
  renderTeams();
}

function renderScoreboard(){
  scoreboardEl.innerHTML = '';
  for(const t of teams){
    const row = document.createElement('div');
    row.style.display='flex';row.style.justifyContent='space-between';row.style.alignItems='center';
    row.style.padding='6px';row.style.borderRadius='6px';row.style.background='#fff';
    row.innerHTML = `<div style="font-weight:700">${t.name}</div><div style="font-weight:900;color:${t.color}">${t.score}</div>`;
    scoreboardEl.appendChild(row);
  }
}

// attempt placement
function tryPlace(cardId, eraId){
  if(!selectedTeamId){ alert('Lütfen önce bir takım seçin.'); return; }
  // check if already placed
  if(placed[cardId]){
    log(`(Uyarı) Bu kart zaten yerleştirildi: ${cardId}`);
    return;
  }
  const card = CARDS.find(c=>c.id===cardId);
  const era = ERAS.find(e=>e.id===eraId);
  if(!card || !era) return;

  // scoring logic
  // if card.year within era.rangeStart..era.rangeEnd => correct
  // if within +/- 50 years of boundaries => near (example)
  let awarded = 0, reason='';
  if(card.year >= era.rangeStart && card.year <= era.rangeEnd){
    awarded = 10; reason='Doğru yerleştirme';
  } else {
    // compute distance to closest boundary in years
    const dist = Math.min(Math.abs(card.year - era.rangeStart), Math.abs(card.year - era.rangeEnd));
    // define "near" threshold 60 years (for demo)
    if(dist <= 60) { awarded = 5; reason='Yakın yerleştirme'; }
    else { awarded = 0; reason='Yanlış yerleştirme'; }
  }

  // record placement
  placed[cardId] = eraId;
  // update team score
  const team = teams.find(t=>t.id===selectedTeamId);
  if(!team) return;
  team.score += awarded;
  renderTeams();

  // visually move card into era
  const cardEl = document.getElementById('card-' + cardId);
  if(cardEl){
    // shrink and append
    cardEl.style.opacity = '0.95';
    cardEl.style.transform = 'translateY(0)';
    cardEl.style.cursor = 'default';
    cardEl.draggable = false;
    // clone small label into era
    const small = document.createElement('div');
    small.className = 'card small';
    small.style.borderLeft = `6px solid ${team.color}`;
    small.innerHTML = `<strong style="font-size:13px">${card.title}</strong><div style="font-size:11px;color:var(--muted)">${card.year>0 ? card.year : Math.abs(card.year)+' M.Ö.'}</div>`;
    document.getElementById('era-' + eraId).appendChild(small);
    cardEl.remove();
  }

  log(`${team.name} takımı: "${card.title}" → ${era.name} (${reason}) [+${awarded}]`);
}

// logging
function log(text){
  const d = new Date();
  const t = d.toLocaleTimeString();
  const line = document.createElement('div');
  line.textContent = `[${t}] ${text}`;
  logEl.prepend(line);
}

// reset
function resetAll(){
  if(!confirm('Tüm yerleştirmeleri sıfırlamak istiyor musunuz?')) return;
  // reset variables
  placed = {};
  teams.forEach(t=> t.score = 0);
  // clear eras content and rebuild base eras
  document.querySelectorAll('.era').forEach(e=> {
    const id = e.dataset.era;
    e.innerHTML = `<div class="era-name">${ERAS.find(x=>x.id===id).name}</div><div class="era-range">${ERAS.find(x=>x.id===id).displayRange}</div><div style="flex:1"></div><div style="font-size:12px;color:var(--muted)">Bırakmak için buraya sürükleyin</div>`;
  });
  // rebuild board
  boardEl.innerHTML = '';
  for(const c of CARDS){
    const el = makeCard(c);
    boardEl.appendChild(el);
  }
  renderTeams();
  log('Oyun sıfırlandı.');
}

// show results
function showResults(){
  let s = '--- Skor Tablosu ---\n';
  const sorted = [...teams].sort((a,b)=>b.score-a.score);
  sorted.forEach((t,i)=> s += `${i+1}. ${t.name} — ${t.score} puan\n`);
  alert(s);
}

function getScoreText(){
  const sorted = [...teams].sort((a,b)=>b.score-a.score);
  let text = 'Zamanin Misketleri - Skor\n';
  sorted.forEach((t,i)=> text += `${i+1}. ${t.name} — ${t.score} puan\n`);
  return text;
}

function randomColor(){
  const colors = ['#0ea5e9','#f97316','#10b981','#ef4444','#8b5cf6','#06b6d4','#f43f5e'];
  return colors[Math.floor(Math.random()*colors.length)];
}

</script>
</body>
</html>

